<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parsimonious flux balance analysis · COBREXA.jl</title><meta name="title" content="Parsimonious flux balance analysis · COBREXA.jl"/><meta property="og:title" content="Parsimonious flux balance analysis · COBREXA.jl"/><meta property="twitter:title" content="Parsimonious flux balance analysis · COBREXA.jl"/><meta name="description" content="Documentation for COBREXA.jl."/><meta property="og:description" content="Documentation for COBREXA.jl."/><meta property="twitter:description" content="Documentation for COBREXA.jl."/><meta property="og:url" content="https://cobrexa.github.io/COBREXA.jl/stable/examples/03b-parsimonious-flux-balance/"/><meta property="twitter:url" content="https://cobrexa.github.io/COBREXA.jl/stable/examples/03b-parsimonious-flux-balance/"/><link rel="canonical" href="https://cobrexa.github.io/COBREXA.jl/stable/examples/03b-parsimonious-flux-balance/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="COBREXA.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="COBREXA.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">COBREXA.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../">Contents</a></li><li><a class="tocitem" href="../01-loading-and-saving/">Loading and saving models</a></li><li><a class="tocitem" href="../02a-flux-balance-analysis/">Flux balance analysis (FBA)</a></li><li><a class="tocitem" href="../02b-optimizer-parameters/">Changing optimizer parameters</a></li><li><a class="tocitem" href="../02c-model-modifications/">Making adjustments to the model</a></li><li><a class="tocitem" href="../02d-constraint-modifications/">Making adjustments to the constraint system</a></li><li><a class="tocitem" href="../03a-flux-variability-analysis/">Flux variability analysis (FVA)</a></li><li class="is-active"><a class="tocitem" href>Parsimonious flux balance analysis</a><ul class="internal"><li><a class="tocitem" href="#Using-different-solvers-for-the-problem-stages"><span>Using different solvers for the problem stages</span></a></li><li><a class="tocitem" href="#Using-linear-(L1)-parsimonious-constraints"><span>Using linear (L1) parsimonious constraints</span></a></li></ul></li><li><a class="tocitem" href="../03c-envelopes/">Production envelopes</a></li><li><a class="tocitem" href="../04-community-models/">Community FBA models</a></li><li><a class="tocitem" href="../05a-minimization-of-metabolic-adjustment/">Minimization of metabolic adjustment analysis</a></li><li><a class="tocitem" href="../05b-enzyme-constrained-models/">Enzyme constrained models</a></li><li><a class="tocitem" href="../05c-mmdf/">Thermodynamic models</a></li><li><a class="tocitem" href="../05d-loopless-models/">Loopless flux balance analysis (ll-FBA)</a></li><li><a class="tocitem" href="../05e-knockouts/">Gene knockouts</a></li><li><a class="tocitem" href="../05f-cyclefree/">CycleFreeFlux</a></li><li><a class="tocitem" href="../05g-gapfilling/">Gap filling</a></li><li><a class="tocitem" href="../06a-sampling/">Flux sampling</a></li><li><a class="tocitem" href="../06b-screening/">Screening through many model variants</a></li></ul></li><li><a class="tocitem" href="../../structure/">Core concepts and structure</a></li><li><span class="tocitem">Parallel, distributed and HPC processing</span><ul><li><a class="tocitem" href="../../distributed/">Contents</a></li><li><a class="tocitem" href="../../distributed/1_functions/">Parallel processing overview</a></li><li><a class="tocitem" href="../../distributed/2_parallel/">Local parallel processing</a></li><li><a class="tocitem" href="../../distributed/3_slurm/">Working in a HPC environment</a></li></ul></li><li><span class="tocitem">API reference</span><ul><li><a class="tocitem" href="../../reference/">Contents</a></li><li><a class="tocitem" href="../../reference/analysis/">Specialized analysis functions</a></li><li><a class="tocitem" href="../../reference/builders/">Constraint system builders</a></li><li><a class="tocitem" href="../../reference/core/">Core functionality</a></li><li><a class="tocitem" href="../../reference/frontend/">Front-end user interface</a></li><li><a class="tocitem" href="../../reference/misc/">Miscellaneous functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Parsimonious flux balance analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parsimonious flux balance analysis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/COBREXA/COBREXA.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/COBREXA/COBREXA.jl/blob/master/docs/src/examples/03b-parsimonious-flux-balance.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Parsimonious-flux-balance-analysis"><a class="docs-heading-anchor" href="#Parsimonious-flux-balance-analysis">Parsimonious flux balance analysis</a><a id="Parsimonious-flux-balance-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Parsimonious-flux-balance-analysis" title="Permalink"></a></h1><p>Here, we use <a href="../../reference/frontend/#COBREXA.parsimonious_flux_balance_analysis-Tuple{AbstractFBCModels.AbstractFBCModel}"><code>parsimonious_flux_balance_analysis</code></a> (pFBA) to find the optimal flux distribution in the <em>E. coli</em> &quot;core&quot; model. In essence, pFBA first uses FBA to find an optimal objective value for the model, and then minimizes the squared distance of the flux from the zero (i.e., minimizes its L2 norm). As the main benefit, this gives a unique (and possibly more realistic) solution to the model.</p><pre><code class="language-julia hljs">using COBREXA

download_model(
    &quot;http://bigg.ucsd.edu/static/models/e_coli_core.json&quot;,
    &quot;e_coli_core.json&quot;,
    &quot;7bedec10576cfe935b19218dc881f3fb14f890a1871448fc19a9b4ee15b448d8&quot;,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;e_coli_core.json&quot;</code></pre><p>Notably, we need an optimizer that can solve quadratic (QP) models:</p><pre><code class="language-julia hljs">import Clarabel

import JSONFBCModels
model = load_model(&quot;e_coli_core.json&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">JSONFBCModels.JSONFBCModel(#= 95 reactions, 72 metabolites =#)</code></pre><p>The pFBA is, in its most default form, implemented in function <a href="../../reference/frontend/#COBREXA.parsimonious_flux_balance_analysis-Tuple{AbstractFBCModels.AbstractFBCModel}"><code>parsimonious_flux_balance_analysis</code></a>:</p><pre><code class="language-julia hljs">solution = parsimonious_flux_balance_analysis(model; optimizer = Clarabel.Optimizer)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ConstraintTrees.Tree{Float64} with 5 elements:
  :coupling               =&gt; ConstraintTrees.Tree{Float64}(#= 0 elements =#)
  :flux_stoichiometry     =&gt; ConstraintTrees.Tree{Float64}(#= 72 elements =#)
  :fluxes                 =&gt; ConstraintTrees.Tree{Float64}(#= 95 elements =#)
  :objective              =&gt; 0.873922
  :parsimonious_objective =&gt; 11414.2</code></pre><pre><code class="language-julia hljs">solution.fluxes</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ConstraintTrees.Tree{Float64} with 95 elements:
  :ACALD                    =&gt; -1.10007e-10
  :ACALDt                   =&gt; -3.18315e-11
  :ACKr                     =&gt; -4.99153e-11
  :ACONTa                   =&gt; 6.00725
  :ACONTb                   =&gt; 6.00725
  :ACt2r                    =&gt; -3.36167e-11
  :ADK1                     =&gt; -9.84745e-12
  :AKGDH                    =&gt; 5.06438
  :AKGt2r                   =&gt; -4.87392e-11
  :ALCD2x                   =&gt; -6.24263e-11
  :ATPM                     =&gt; 8.39
  :ATPS4r                   =&gt; 45.514
  :BIOMASS_Ecoli_core_w_GAM =&gt; 0.873922
  :CO2t                     =&gt; -22.8098
  :CS                       =&gt; 6.00725
  :CYTBD                    =&gt; 43.599
  :D_LACt2                  =&gt; -4.43927e-11
  :ENO                      =&gt; 14.7161
  :ETOHt2r                  =&gt; -4.18493e-11
  ⋮                         =&gt; ⋮</code></pre><h2 id="Using-different-solvers-for-the-problem-stages"><a class="docs-heading-anchor" href="#Using-different-solvers-for-the-problem-stages">Using different solvers for the problem stages</a><a id="Using-different-solvers-for-the-problem-stages-1"></a><a class="docs-heading-anchor-permalink" href="#Using-different-solvers-for-the-problem-stages" title="Permalink"></a></h2><p>Sometimes it is useful to employ a dedicated LP solver to find the solution to the original FBA problem, and then a dedicated QP solver to minimize the fluxes. We can set the optimizer and parsimonious optimizer separately using keyword arguments:</p><pre><code class="language-julia hljs">import HiGHS

solution = parsimonious_flux_balance_analysis(
    model;
    optimizer = HiGHS.Optimizer, # HiGHS is used only for LP here
    parsimonious_optimizer = Clarabel.Optimizer, # Clarabel is great for solving QPs
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ConstraintTrees.Tree{Float64} with 5 elements:
  :coupling               =&gt; ConstraintTrees.Tree{Float64}(#= 0 elements =#)
  :flux_stoichiometry     =&gt; ConstraintTrees.Tree{Float64}(#= 72 elements =#)
  :fluxes                 =&gt; ConstraintTrees.Tree{Float64}(#= 95 elements =#)
  :objective              =&gt; 0.873922
  :parsimonious_objective =&gt; 11414.2</code></pre><h2 id="Using-linear-(L1)-parsimonious-constraints"><a class="docs-heading-anchor" href="#Using-linear-(L1)-parsimonious-constraints">Using linear (L1) parsimonious constraints</a><a id="Using-linear-(L1)-parsimonious-constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Using-linear-(L1)-parsimonious-constraints" title="Permalink"></a></h2><p>For efficiency reasons, it is also possible to use a pFBA version that optimizes the L1 norm instead of the L2 one (i.e., minimizing a sum of absolute values instead of the sum of squares). In turn, the uniqueness property of the solution is lost, but we do not need a QP-capable optimizer at all:</p><pre><code class="language-julia hljs">linear_solution =
    linear_parsimonious_flux_balance_analysis(model; optimizer = HiGHS.Optimizer)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ConstraintTrees.Tree{Float64} with 8 elements:
  :coupling                 =&gt; ConstraintTrees.Tree{Float64}(#= 0 elements =#)
  :directional_flux_balance =&gt; ConstraintTrees.Tree{Float64}(#= 95 elements =#)
  :flux_stoichiometry       =&gt; ConstraintTrees.Tree{Float64}(#= 72 elements =#)
  :fluxes                   =&gt; ConstraintTrees.Tree{Float64}(#= 95 elements =#)
  :fluxes_forward           =&gt; ConstraintTrees.Tree{Float64}(#= 95 elements =#)
  :fluxes_reverse           =&gt; ConstraintTrees.Tree{Float64}(#= 95 elements =#)
  :objective                =&gt; 0.873922
  :parsimonious_objective   =&gt; 518.422</code></pre><pre><code class="language-julia hljs">linear_solution.fluxes</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ConstraintTrees.Tree{Float64} with 95 elements:
  :ACALD                    =&gt; 0.0
  :ACALDt                   =&gt; 0.0
  :ACKr                     =&gt; 5.03064e-14
  :ACONTa                   =&gt; 6.00725
  :ACONTb                   =&gt; 6.00725
  :ACt2r                    =&gt; 5.03064e-14
  :ADK1                     =&gt; 0.0
  :AKGDH                    =&gt; 5.06438
  :AKGt2r                   =&gt; 0.0
  :ALCD2x                   =&gt; 0.0
  :ATPM                     =&gt; 8.39
  :ATPS4r                   =&gt; 45.514
  :BIOMASS_Ecoli_core_w_GAM =&gt; 0.873922
  :CO2t                     =&gt; -22.8098
  :CS                       =&gt; 6.00725
  :CYTBD                    =&gt; 43.599
  :D_LACt2                  =&gt; 0.0
  :ENO                      =&gt; 14.7161
  :ETOHt2r                  =&gt; 0.0
  ⋮                         =&gt; ⋮</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../03a-flux-variability-analysis/">« Flux variability analysis (FVA)</a><a class="docs-footer-nextpage" href="../03c-envelopes/">Production envelopes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 16 October 2024 18:05">Wednesday 16 October 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
